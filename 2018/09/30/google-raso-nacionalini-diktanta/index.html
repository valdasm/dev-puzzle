<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" itemprop="description" content="Google kalbos atpažinimo (ang. speech to text) funkcionalumo bandymas su 2017 m. Nacionalinio diktanto įrašu " /> <meta name="keywords" itemprop="keywords" content="speech to text, nacionalinis diktantas, kalbos atpažinimas, dirbtinis intelektas" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <!-- <meta name="google-site-verification" content="asdfasdf" /> --> <meta name="og:site_name" itemprop="name" content="Valdas Maksimavičius"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="og:image" content="https://www.valdas.blog/images/2018/09/speech_cover.jpg"/><meta name="twitter:image" content="https://www.valdas.blog/images/2018/09/speech_cover.jpg"/><meta name="og:image:width" content="474"/> <meta name="twitter:image:width" content="474"/><meta name="og:image:height" content="249"/> <meta name="twitter:image:height" content="249"/><meta name="twitter:card" content="summary"/><meta name="twitter:image:alt" content="Main picture"/> <meta name="twitter:account_id" content="1525926511" /> <meta name="twitter:creator" content="@VMaksimavicius"/> <meta name="twitter:site" content="@VMaksimavicius"/> <meta name="twitter:title" property="og:title" content="Google lietuvių kalbos atpažinimas rašo Nacionalinį diktantą!"/> <meta name="twitter:description" property="og:description" content="Google kalbos atpažinimo (ang. speech to text) funkcionalumo bandymas su 2017 m. Nacionalinio diktanto įrašu "/> <meta name="twitter:url" property="og:url" content="https://www.valdas.blog/2018/09/30/google-raso-nacionalini-diktanta/"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="valdas.blog" /> <link rel="shortcut icon" href="/favicon.ico?"/> <link rel="apple-touch-icon" href="/favicon.ico?"/> <link rel="alternate" type="application/rss+xml" title="RSS for valdas.blog" href="https://www.valdas.blog/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?"/> <link rel="stylesheet" href="/css/icons.css?"/> <link rel="canonical" href="https://www.valdas.blog/2018/09/30/google-raso-nacionalini-diktanta/" itemprop="url" /> <!-- <link rel="amphtml" href="https://www.valdas.blog/2018/09/30/google-raso-nacionalini-diktanta/" /> --> <title>Google lietuvių kalbos atpažinimas rašo Nacionalinį diktantą! </title> </head> <body> <div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"> <div class="face"> <a href="/about-me/"> <img src="https://www.valdas.blog/images/valdas-maksimavicius-192x192.png" class="photo" alt="Valdas Maksimavičius"/> </a> </div> <nav> <ul class="menu social notranslate"> <li><a href="/rss.xml" re="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/valdasm" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/valdasm" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:valdas@maksimavicius.eu" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li> </ul> <ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li><a href="/best/" title="Recommended reading">Recommended</a></li> <li><a href="/archive/" title="All archives">Archive</a></li> <li><a href="/notes/" title="Notes">Notes</a></li> <!-- <li><a href="/talks/" title="Public speaking, presentations">Talks</a></li> --> <li><a href="http://eepurl.com/dcCxAD" target="_blank" title="Subscribe">Subscribe</a></li> <li><a href="/about-me/" title="About me">About</a></li> </ul> </nav> </header> </div> <section itemscope="" itemtype="http://schema.org/BlogPosting"> <div itemprop="dateModified" content="2018-09-30T00:00:00+00:00"></div> <div itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="https://www.valdas.blog/images/valdas-maksimavicius-1400x1400.png"/> </div> <div itemscope="" itemprop="publisher" itemtype="http://schema.org/Organization"> <meta itemprop="name" content="Valdas' Blog"/> <div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="https://www.valdas.blog/images/valdas-maksimavicius-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/> </div> </div> <div class="wrapper"> <header> <h1 itemprop="name headline mainEntityOfPage">Google lietuvių kalbos atpažinimas rašo Nacionalinį diktantą!</h1> <ul class="subline"> <li> <time itemprop="datePublished" datetime="2018-09-30T00:00:00+00:00"> 30 September 2018 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Valdas Maksimavičius</span> </li> <!-- <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.valdas.blog/2018/09/30/google-raso-nacionalini-diktanta/#disqus_thread" itemprop="discussionUrl">comments</a> </li> --> </ul> </header> <main> <article class="main" itemprop="articleBody"> <div > <p>Šiandien išbandysime <a href="https://cloud.google.com/speech-to-text/" target="_blank">Google kalbos atpažinimo</a> (speech to text) funkcionalumą. Google dar 2017 metai gyrėsi 95% anglų atpažinimo tikslumu, bet mane labiau domina JAV technologijų gigantės lietuvių kalbos gebėjimai.</p> <p>Pirmieji bandymai užrašyti mano ištartas frazes paliko įspūdį, Google tik retkarčiais praleisdavo žodį ar įterpdavo nesąmonę. Pirmasis pastebėjimas - Google lietuvių kalbos atpažinimas yra labai jautrus kirčiavimui, pašaliniams garsams. Kilo mintis išbandyti šį funkcionalumą su profesionalaus lektoriaus garso įrašu: 2017 metų Nacionaliniu diktantu. Nusprendžiau parašyti programą, kurią būtų galima lengvai užleisti pakartotinai ir taip patikrinti funkcionalumo tobulėjimą ateityje.</p> <p>Prisipažinsiu, bijau Google parašys diktantą geriau už mane :)</p> <!--more--> <p><img src="/images/2018/09/speech_google_listens.gif" alt="" class="img-responsive" /></p> <h2 id="ktu-tyrimas">KTU tyrimas</h2> <p>2016 m. grupė KTU mokslininkų <a href="https://www.researchgate.net/publication/308495820_Google_Lithuanian_Speech_Recognition_Efficiency_Evaluation_Research" target="_blank">tyrė Google kalbos atpažinimo funkcionalumą.</a> Atpažintų <a href="https://en.wikipedia.org/wiki/Word_error_rate" target="_blank">žodžių klaidų lygis (WER - Word Error Rate )</a> siekė 40%.</p> <table> <thead> <tr> <th style="text-align: center">2016 m. problematiška frazė;</th> <th style="text-align: center">atpažinta kaip</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">penktas</td> <td style="text-align: center">tanki test</td> </tr> <tr> <td style="text-align: center">išsijunk</td> <td style="text-align: center">iš trijų</td> </tr> <tr> <td style="text-align: center">sviestas</td> <td style="text-align: center">speed test</td> </tr> <tr> <td style="text-align: center">lizosoma</td> <td style="text-align: center">visos stoma</td> </tr> <tr> <td style="text-align: center">taikyk</td> <td style="text-align: center">tai kiek</td> </tr> <tr> <td style="text-align: center">dešinėn</td> <td style="text-align: center">dešimt min</td> </tr> <tr> <td style="text-align: center">padidink</td> <td style="text-align: center">lady zippy</td> </tr> <tr> <td style="text-align: center">šunkelis</td> <td style="text-align: center">šunų kelis</td> </tr> <tr> <td style="text-align: center">išsijunk</td> <td style="text-align: center">iš jų</td> </tr> <tr> <td style="text-align: center">bjaurus</td> <td style="text-align: center">į eurus</td> </tr> <tr> <td style="text-align: center">rnr</td> <td style="text-align: center">prie neries</td> </tr> <tr> <td style="text-align: center">aštuntas</td> <td style="text-align: center">pašto kodas</td> </tr> </tbody> </table> <h2 id="pasiruošimas-diktanto-eksperimentui">Pasiruošimas diktanto eksperimentui</h2> <ul> <li>Surandu originalų tekstą ir audio įrašą <a href="http://www.vlkk.lt/naujienos/kitos-naujienos/diktantas-bedugne-su-skyrybos-paaiskinimais" target="_blank">Valstybinės lietuvių kalbos komisijos tinklapyje (VLKK)</a></li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Naktį pasnigo, miškas nubalo. 
Nendrės, juosiančios ežerėlį, buvo tarytum paslaptingi 
hieroglifai, kaligrafo įrėžti į tylą, neperskaitomi, 
todėl nebylūs.
...
</code></pre></div></div> <ul> <li> <p>Formatuoju originalų tekstą sakinius perkeliant į atskiras eilutes (galimybė surasti audio failą pagal sakinio vietą faile)</p> </li> <li> <p>Karpau audio failą į sakinius ir saugoju juos į atskirus failus</p> </li> </ul> <p><img src="/images/2018/09/speech_audition.jpg" alt="" class="img-responsive" /></p> <ul> <li>Konfigūruoju Google Cloud: reikalingas Speech-To-Api planas ir Google Storage (nemokamas planas metams prisijungus pirmą kartą)</li> </ul> <p><img src="/images/2018/09/speech_google.jpg" alt="" class="img-responsive" /></p> <ul> <li>Rašau Python programą: daugiau informacijos <a href="https://github.com/valdasm/lt-dictation-to-text" target="_blank">GitHub valdasm/lt-dictation-to-text</a></li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">speech</span>
<span class="kn">from</span> <span class="nn">google.cloud.speech</span> <span class="kn">import</span> <span class="n">enums</span>
<span class="kn">from</span> <span class="nn">google.cloud.speech</span> <span class="kn">import</span> <span class="n">types</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">speech</span><span class="o">.</span><span class="n">SpeechClient</span><span class="p">()</span>

<span class="n">audio</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">RecognitionAudio</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="n">gcs_uri</span><span class="p">)</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">RecognitionConfig</span><span class="p">(</span>
    <span class="n">encoding</span><span class="o">=</span><span class="n">enums</span><span class="o">.</span><span class="n">RecognitionConfig</span><span class="o">.</span><span class="n">AudioEncoding</span><span class="o">.</span><span class="n">FLAC</span><span class="p">,</span>
    <span class="n">sample_rate_hertz</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
    <span class="n">language_code</span><span class="o">=</span><span class="s">'lt-LT'</span><span class="p">)</span>
</code></pre></div></div> <h2 id="diktanto-rašymas">Diktanto rašymas</h2> <p>Pirmiausiai supraskime kokia yra audio įrašo struktūra: lektorius perskaito visą tekstą, tada lėtai skaito kiekvieną sakinį kartodamas frazes, galiausiai, lektorius dar kartą perskaito visą tekstą.</p> <p>Sukurta Python programėlė siunčia tiek pilnų sakinių, tiek atskirų frazių pakartojimus. Pilnus sakinius lyginu su originaliu tekstu iš VLKK ir naudoju tolimesnei analizei.</p> <p>Frazių atpažinimo rezultatai reikalauja mano įsikišimo norint sujungti viską į vientisus sakinius, tad eksperimentas nebebūtų objektyvus. Įdomumo dėlei, frazių atpažinimo tikslumo įverčius išsaugoju atskirame faile (data\raw_detailed_output.md).</p> <p><img src="/images/2018/09/speech_running.jpg" alt="" class="img-responsive" /></p> <h2 id="rezultatai">Rezultatai</h2> <h4 id="atpažinimo-įverčiai">Atpažinimo įverčiai</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Orginalas: Danius nedrąsiai šyptelėjo

Atmestas: Danijos migracija išėjo
Confidence: 0.72

Pasirinktas: Darius nedrąsiai šyptelėjo
Confidence: 0.73
</code></pre></div></div> <h4 id="sakinių-lyginimas">Sakinių lyginimas</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- danius nedrąsiai šyptelėjo
?   ^
+ darius nedrąsiai šyptelėjo
?   ^

- Orginalas
+ Google
</code></pre></div></div> <h4 id="Žodžių-klaidų-lygis">Žodžių klaidų lygis</h4> <p>Google kalbos atpažinimo efektyvumui suskaičiuoti pasitelkiau <a href="https://en.wikipedia.org/wiki/Word_error_rate" target="_blank">žodžių klaidų lygio formule</a> (kiek žodžių pašalinta, pakeista, nereikalingai įterpta iš visų žodžių originalo tekste).</p> <p><strong>Be kartojimo</strong></p> <p>Žodžių klaidų lygis (WER): 39.55% (Įterpta: 40 Pašalinta: 5 Pakeista: 95 Originalas: 354 )</p> <p><strong>Sakinio pakartojimas (naudojant skirtingus įrašus)</strong></p> <p>Žodžių klaidų lygis (WER): 36.44% (Įterpta: 19 Pašalinta: 14 Pakeista: 96 Originalas: 354 )</p> <h2 id="Įdomios-frazės">Įdomios frazės</h2> <p>“paslaptingi hieroglifai, kaligrafo įrėžti” -&gt; “paslaptingi vyro klipai pririšti” “išgirdo švelnius vos juntamus” -&gt; “švelnius losjonus”</p> <h2 id="tobulinimas">Tobulinimas</h2> <p><strong>1. Frazių kartojimas</strong></p> <p>Analizuojant atskirų frazių pasitikėjimo koeficjentus, matosi kad ištraukos yra kartais užrašomos tiksliau už sakinius. Tačiau jų logiškas sujungimas į vientisą sakinį jau reikalautų mano įsikišimo.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Orginalas: Rodėsi keista, kad neįmanoma pasakyti, 
           koks gi dabar paros metas

Pasirinktas: rūdys ir keista kad neįmanoma 
             pasakyti koks gi dabar paros metas

rūdys ir keista
0.8809462785720825
rodėsi keista
0.9402069449424744
</code></pre></div></div> <p>Verčiant visą sakinį Google išgirdo “rūdys ir keista kad …”. Bet jau verčiant trumpas frazes, “rodėsi keista” buvo aptiktas su aukštu pasitikėjimo koeficjentu.</p> <p><strong>2. Nepasitikintis Google</strong></p> <p>Retkarčiais, Google pasirinko prastesnį vertimą (mano manymu):</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Orginalas: Tėti, jeigu tas paveikslas tave gąsdina, 
           aš jį nukabinsiu

Pasirinktas: tai jeigu tas paveikslas Tele2
Confidence: 0.76

Atmestas: tiltai jeigu tas paveikslas tave gąsdina 
          aš nukrisiu
Confidence: 0.75
</code></pre></div></div> <p>Antras sakinys yra arčiau tiesios, bet pasitikėjimo lygis yra didesnis prie pirmojo, kurį Google ir pasirinko.</p> <p><strong>3. Didžiųjų raidžių ir skyrybos ženklų nepaisymas</strong></p> <p>Google kalbos atpažinimas turi problemų su skyrybos ženklais. Kadangi norėjau pagrindinai atkreipti dėmesį tik į žodžių atpažinimą, originaliame tekste pašalinau skyrybos ženklus o didžiąsias raides paverčiau mažosiomis.</p> <h1 id="apibendrinimas">Apibendrinimas</h1> <p>Lietuvių kalba nėra taip populiari kaip anglų, tad ir teksto atpažinimas veikia ženkliai prasčiau. Be abejo, Google funkcionalumas tikrai tobulės, tad bus smagu pamatyti kaip atpažinimas veiks ateityje. KTU mokslininkų išsamus Google funkcionalumo testas atliktas 2016 metais vidutiniškai pasiekė 40% žodžių klaidų lygį. Mano mėgėjiškas eksperimentas su vieno lektoriaus įrašu - 36.44%.</p> <p><strong>Nuorodos:</strong></p> <ul> <li><a href="https://github.com/valdasm/lt-dictation-to-text" target="_blank">GitHub valdasm/lt-dictation-to-text</a></li> <li><a href="https://cloud.google.com/speech-to-text/" target="_blank">Google Speech to Text</a></li> <li><a href="https://www.researchgate.net/publication/308495820_Google_Lithuanian_Speech_Recognition_Efficiency_Evaluation_Research" target="_blank">Google Lithuanian Speech Recognition Efficiency Evaluation Research</a></li> </ul> </div> </article> </main> <header> <p class="unprintable"><a href='/tag/lithuanian/' class='tag notranslate'>lithuanian</a> <a href='/tag/software/' class='tag notranslate'>software</a></p> <nav class="buttons notranslate"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.valdas.blog/2018/09/30/google-raso-nacionalini-diktanta/" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.valdas.blog/2018/09/30/google-raso-nacionalini-diktanta/" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.valdas.blog/2018/09/30/google-raso-nacionalini-diktanta/%3F2018-39&amp;title=Google+lietuvi%C5%B3+kalbos+atpa%C5%BEinimas+ra%C5%A1o+Nacionalin%C4%AF+diktant%C4%85%21" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> </nav> </header> </div> <!-- --> <div class="disqus" role="complementary"> <div id="disqus_thread" class="disqus-thread"></div> <script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url.split('.html')[0]; }; (function() { var d = document, s = d.createElement('script'); s.src = '//valdas-blog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript> <div> <p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post. </p> </div> </noscript> </div> </section> <div class="wrapper"> <footer class="footer"> <p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Valdas Maksimavičius</span> </span> <span itemprop="copyrightYear">2018</span> </p> </footer> </div> <script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?"></script> <script>var disqus_shortname = 'valdas-blog';</script> <script id="dsq-count-scr" src="//valdas-blog.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-53567712-3', 'auto'); ga('send', 'pageview'); </script> <script language="javascript" type="text/javascript"> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script language="javascript1.1" type="text/javascript"> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script language="javascript1.2" type="text/javascript"> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> </body> </html>
